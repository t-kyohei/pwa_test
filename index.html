<!DOCTYPE html>
<html>
    <head>
        <title>PWA_TEST</title>
         <meta http-equiv="content-type" charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="manifest" href="manifest.json">
        <link rel="stylesheet" type="text/css" href="btn.css" />
        <script src="js/payment.js"></script>

<script>
window.addEventListener('load', function() {
  
 if ('serviceWorker' in navigator) {
  navigator.serviceWorker
    .register('sw.js')
    .then(registration => {
      // 登録成功
      registration.onupdatefound = function() {
        console.log('アップデートがあります！');
        registration.update();
      }
    })
    .catch(err => {
      // 登録失敗
  });
}



});
</script>

<script src="https://pay.google.com/gp/p/js/pay.js"></script>


    </head>
    <body>
<h1>PWA検証サンプル5</h1>
<div class="container">
<a href="camera" class="btn-square">カメラを起動</a>
</div>
<br>
<br>
<div class="container">
<a href="location" class="btn-square">位置情報取得画面</a>
</div>
<br>
<br>

<div class="container">
<button class="btn-square" onclick="pay()">支払い(PaymemtRequestAPI)</button>
</div>

<!--
<br>
<br>
<a href="pay" class="btn-square">GooglePay呼び出しサンプル画面</a>-->
<br>
<br>
<br>
<a href="weather" class="btn-square">天気予報登録(バックグラウンド同期)</a>
<br>
<br>
<br>
<button class="add-button">ホーム画面に追加</button>
<!--<div class="container">
<a href="push" class="btn-square">push</a>
</div>
<div class="container">
<a href="push2" class="btn-square">push2</a>
</div>
<div class="container">
<a href="push3" class="btn-square">push3</a>
</div>
<div class="container">
<a href="push4" class="btn-square">push4</a>
</div>
<div class="container">
<a href="push5" class="btn-square">push5</a>
</div>
<div class="container">
<a href="push6" class="btn-square">push6</a>
</div>-->
    </body>
<style>
.add-button {
  position: absolute;
  top: 1px;
  left: 1px;
}
</style>

<script>
let deferredPrompt;
const addBtn = document.querySelector('.add-button');

window.addEventListener('beforeinstallprompt', (e) => {
  // Prevent Chrome 67 and earlier from automatically showing the prompt
  e.preventDefault();
  // Stash the event so it can be triggered later.
  deferredPrompt = e;
  // Update UI to notify the user they can add to home screen
  addBtn.style.display = 'block';

  addBtn.addEventListener('click', (e) => {
    // hide our user interface that shows our A2HS button
    addBtn.style.display = 'none';
    // Show the prompt
    deferredPrompt.prompt();
    // Wait for the user to respond to the prompt
    deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the A2HS prompt');
        } else {
          console.log('User dismissed the A2HS prompt');
        }
        deferredPrompt = null;
      });
  });
});

</script>


</html>